var DC=DC||{};DC["do"]=function(){function e(e){a.setStatic(K.bodies[0],e)}var r=Matter.Engine,t=Matter.Render,n=Matter.Runner,a=Matter.Body,o=Matter.Composite,c=Matter.Composites,i=Matter.Common,d=Matter.Constraint,l=Matter.MouseConstraint,s=Matter.Mouse,m=Matter.World,f=Matter.Events,u=Matter.Bodies,p=(Matter.Vertices,Matter.Svg,Matter.Query),g=(Matter.Sleeping,CMDC.clearSource),S=CMDC.eventOff,b=CMDC.timeout,x=CMDC.bhObj,y=CMDC.playAgain,h=CMDC.sourceLinkRoot;DC["do"].createRagdoll=function(e,r,t,n,c){t="undefined"==typeof t?1:t;var l=i.extend({label:"chest",collisionFilter:{group:a.nextGroup(!0)},chamfer:{radius:[10*t,10*t,16*t,16*t]},render:{sprite:{xScale:.7,yScale:.7,texture:h+"img/chest.png"}}},n),s=i.extend({label:"left-arm",collisionFilter:{group:a.nextGroup(!0)},chamfer:{radius:10*t},render:{fillStyle:"#bdbabb"},stiffness:.8},n),m=i.extend({},s,{label:"left-lower-arm",render:{fillStyle:"#cfcdd2"},chamfer:{radius:6*t},friction:.7}),f=i.extend({label:"right-arm",collisionFilter:{group:a.nextGroup(!0)},chamfer:{radius:10*t},render:{fillStyle:"#bdbabb"},stiffness:.8},n),p=i.extend({},f,{label:"right-lower-arm",render:{fillStyle:"#cfcdd2"},chamfer:{radius:6*t},friction:.7}),g=u.rectangle(e,r,45*t,30*t,l),S=u.rectangle(e+39*t,r-15*t,17*t,54*t,f),b=u.rectangle(e+39*t,r+25*t,14*t,86*t,p),x=u.rectangle(e-39*t,r-15*t,17*t,54*t,s),y=u.rectangle(e-39*t,r+25*t,14*t,86*t,m),v=d.create({label:"CHEST_TO_RIGHT_UPPER",bodyA:g,pointA:{x:24*t,y:0},pointB:{x:0,y:-32*t},bodyB:S,stiffness:.8,angularStiffness:.2,length:0,render:{anchors:!1,visible:!1}}),C=d.create({label:"CHEST_TO_LEFT_UPPER",bodyA:g,pointA:{x:-24*t,y:0},pointB:{x:0,y:-32*t},bodyB:x,stiffness:.8,angularStiffness:.2,length:0,render:{anchors:!1,visible:!1}}),M=d.create({label:"UPPER_TO_LOWER_RIGHT",bodyA:S,bodyB:b,pointA:{x:0,y:20*t},pointB:{x:0,y:-36*t},stiffness:.6,angularStiffness:1.2,render:{visible:!0,anchors:!1},length:0}),A=d.create({label:"UPPER_TO_LOWER_LEFT",bodyA:x,bodyB:y,pointA:{x:0,y:20*t},pointB:{x:0,y:-36*t},stiffness:.6,angularStiffness:1.2,render:{visible:!0,anchors:!1},length:0});return o.create({bodies:[g,y,x,b,S],constraints:[A,M,C,v]})},DC["do"].createStacks=function(e){return c.stack(e.x,e.y,e.columns,e.rows,0,0,function(e,r){return i.random()<.05?u.rectangle(e+15*i.random(),r+15*i.random(),26,16,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:h+"img/double11_1.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.05&&i.random()<.1?u.rectangle(e+15*i.random(),r+30*i.random(),24,24,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:"//act.cmcmcdn.com/upload/201710/f8e6bdd1572a5e8a2e2f73d8c52b1bf6.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.1&&i.random()<.15?u.rectangle(e+15*i.random(),r+15*i.random(),22,30,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:h+"img/red.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.15&&i.random()<.2?u.rectangle(e+15*i.random(),r+15*i.random(),24,24,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:h+"img/gift.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.2&&i.random()<.25?u.circle(e+15*i.random(),r+5*i.random(),16,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:h+"img/coin.png"}},friction:.7,timeScale:A}):i.random()>.25&&i.random()<.3?u.circle(e+15*i.random(),r+10*i.random(),12,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:h+"img/duck.png"}},friction:.7,timeScale:A}):i.random()>.3&&i.random()<.35?u.circle(e+15*i.random(),r+5*i.random(),16,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:"//act.cmcmcdn.com/upload/201710/bd2bd1fb94a20ca2f9eea1088925050a.png"}},friction:.7,timeScale:A}):i.random()>.35&&i.random()<.4?u.rectangle(e+15*i.random(),r+15*i.random(),28,38,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:"//act.cmcmcdn.com/upload/201710/24af186e46de0d872942ef2709f83b71.gif"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.4&&i.random()<.45?u.rectangle(e+15*i.random(),r+45*i.random(),38,18,{render:{sprite:{xScale:.5-M,yScale:.5-M,texture:"//act.cmcmcdn.com/upload/201710/2a126249ff498557a38cc920a64481c7.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.45&&i.random()<.5?u.rectangle(e+15*i.random(),r+40*i.random(),28,23,{render:{sprite:{xScale:.7-M,yScale:.7-M,texture:h+"img/10.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.5&&i.random()<.55?u.rectangle(e+15*i.random(),r+32*i.random(),38,23,{render:{sprite:{xScale:.7-M,yScale:.7-M,texture:h+"img/500.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.55&&i.random()<.6?u.rectangle(e+15*i.random(),r+44*i.random(),38,23,{render:{sprite:{xScale:.7-M,yScale:.7-M,texture:h+"/img/100.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.6&&i.random()<.65?u.rectangle(e+15*i.random(),r+21*i.random(),63,23,{render:{sprite:{xScale:.7-M,yScale:.7-M,texture:h+"/img/10000.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.65&&i.random()<.7?u.rectangle(e+15*i.random(),r+29*i.random(),28,23,{render:{sprite:{xScale:.7-M,yScale:.7-M,texture:h+"/img/50.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.7&&i.random()<.75?u.rectangle(e+15*i.random(),r+15*i.random(),28,28,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:"//act.cmcmcdn.com/upload/201710/25cd325bae7818e30a4d4676ec0880bf.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.75&&i.random()<.8?u.rectangle(e+15*i.random(),r+15*i.random(),28,28,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:"//act.cmcmcdn.com/upload/201710/c1fede413fbd7b3de23a771472e67d29.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.8&&i.random()<.85?u.rectangle(e+15*i.random(),r+15*i.random(),28,28,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:"//act.cmcmcdn.com/upload/201710/9de67782c268517089e6d031af85405c.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.85&&i.random()<.9?u.rectangle(e+15*i.random(),r+15*i.random(),28,28,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:"//act.cmcmcdn.com/upload/201710/45991158829180f3a86597a0ef781c3a.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):i.random()>.95&&i.random()<1?u.rectangle(e+15*i.random(),r+15*i.random(),28,28,{render:{sprite:{xScale:.8-M,yScale:.8-M,texture:"//act.cmcmcdn.com/upload/201710/328c7178f239ce35264850419510b3be.png"}},chamfer:{radius:5},friction:.7,timeScale:A}):u.circle(e+15*i.random(),r+15*i.random(),16,{render:{sprite:{xScale:.7-M,yScale:.7-M,texture:h+"img/liebao.png"}},friction:.7,timeScale:A})})};var v=!1,C=!1,M=.1,A=.8,w=r.create({}),k=w.world,T=t.create({element:document.body,engine:w,options:{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,background:"transparent",showAngleIndicator:!1,wireframes:!1}}),B=n.create(),E={isStatic:!0,background:"transparent",render:{fillStyle:"#f84851"}},R=document.documentElement.clientWidth,D=40,_=.01;t.run(T),n.run(B,w),k.bodies=[],$("#d-c").css("min-width",R);var F=u.rectangle(0,600,3*R,_,E),O=u.rectangle(0,0,3*R,_,E),P=u.rectangle(.13*-R+D,300,_,620,E),G=u.rectangle(.6*R+D,300,_,620,E);m.add(k,[F,P,G]);var W,H=!1,L=function(){return H?(!y&&$("#switch1").prop("checked",!1),void(y&&$("#switch1").prop("checked",!0))):(C=!1,H=!0,X.length=280,void setTimeout(function(){ee=!0,setTimeout(function(){X.length=10,setTimeout(function(){$(".simpleAlert").length>0||(W=simpleAlert({content:"游戏结束啦！",buttons:{"再玩一次":function(){e(!1),y=!0,$("#switch1").prop("checked",!0),W.close()},"退出":function(){g(),S=!0,W.close(),m.clear(k),$("#d-c").remove(),x.dispose()}}}),e(!0))},3*b)},2.5*b)},b))};$(".start-btn").click(L);var U=0,I={x:180,y:350,columns:12,rows:1};setInterval(function(){if(U++,!(U>3)){var e=DC["do"].createStacks(I);m.add(k,e),I.x*=.5,I.columns+=6,I.rows+=1}},.8*b),setTimeout(function(){V(w),setTimeout(function(){m.add(k,[z,K,Z,O]),$(".start-btn").css("display","block"),v=!0,setTimeout(function(){C=!0},b)},3*b)},3*b);var V=function(e,r){if(r){var t=.0025*r.mass;a.applyForce(r,r.position,{x:(t+i.random()*t)*i.choose([1,-1]),y:-t+i.random()*-t})}else for(var n=o.allBodies(e.world),c=0;c<n.length;c++){var d=n[c];if(!d.isStatic&&d.position.y>=100){var l=.05*d.mass;a.applyForce(d,d.position,{x:(l+i.random()*l)*i.choose([1,-1]),y:-l+i.random()*-l})}}},j=400,Q=a.nextGroup(!0),q=-1,z=c.stack(j,0,2,1,0,10,function(e,r){return u.rectangle(e,r,30,15,{label:"component",collisionFilter:{group:Q},chamfer:.5,render:{sprite:{xScale:.6,yScale:.6,texture:h+"img/component.png"}}})}),J=u.rectangle(400,100,40,25,{label:"arm",render:{strokeStyle:"#3c3f41",sprite:{xScale:.8,yScale:.8,texture:h+"img/arm.png"}}});z.bodies.push(J),c.chain(z,.5,0,-.5,0,{stiffness:1,length:0,render:{visible:!1}}),o.add(z,d.create({label:"spring",bodyB:z.bodies[0],pointB:{x:-20,y:0},pointA:{x:z.bodies[0].position.x,y:z.bodies[0].position.y},stiffness:.01,damping:1,length:10,render:{visible:!0,lineWidth:1.5,strokeStyle:"#29a3f1"}}));var K,N=[],X=z.constraints[2];i.choose(["#556270","#4ECDC4","#C7F464","#FF6B6B","#C44D58"]);K=DC["do"].createRagdoll(400,100,1.1,{},N);var Y,Z=d.create({bodyA:z.bodies[z.bodies.length-1],bodyB:K.bodies[0],pointA:{x:28,y:0},pointB:{x:0,y:-7},length:0,render:{visible:!1}}),ee=!1,re=.5,te=-.5,ne=3.5,ae=-3.5,oe=X.pointA.x;f.on(w,"beforeUpdate",function(e){if(!(!K||K.length<=0||S)&&(ee?(y?(ne+=.03,ae-=.03,re+=.01,te-=.01,ne>=3.5&&(ne=3.5,ae=-3.5),re>=.5&&(re=.5,te=-.5,ee=!1,C=!0,y=!1,H=!1)):(ne-=.02,ae+=.02,re-=.01,te+=.01,ne<=1.2&&(ne=1.2,ae=-1.2),re<=-.95&&(re=-.95,te=.95)),a.setAngle(K.bodies[1],re),a.setAngle(K.bodies[2],ne),a.setAngle(K.bodies[3],te),a.setAngle(K.bodies[4],ae)):(a.setAngle(K.bodies[1],.5),a.setAngle(K.bodies[2],3.3),a.setAngle(K.bodies[3],-.5),a.setAngle(K.bodies[4],-3.3)),C)){if(q+=.015,q<0)return;Y=oe+250*Math.sin(q),!H&&(X.pointA.x=Y)}}),f.on(T,"afterRender",function(){if(v&&!ee&&!S){var e=ie.mouse,r=T.context,n=o.allBodies(w.world),a={x:400,y:100},c=e.position,i=p.ray(n,a,c);t.startViewTransform(T),r.beginPath(),r.moveTo(a.x,a.y),r.lineTo(c.x,c.y),i.length>0?r.strokeStyle="#fff":r.strokeStyle="#555";for(var d=0;d<i.length;d++){var l=i[d];l&&!~["chest","left-arm","right-arm","right-lower-arm","left-lower-arm","component","arm","spring"].indexOf(l.body.label)&&l.body.position.y>=450&&V(w,l.bodyA)}t.endViewTransform(T)}});var ce=s.create(T.canvas),ie=l.create(w,{mouse:ce,constraint:{stiffness:1,render:{visible:!1}}});return f.on(ie,"mouseup",function(e){v&&($("#switch1").prop("checked",!1),L())}),T.mouse=ce,t.lookAt(T,{min:{x:0,y:0},max:{x:800,y:600}}),$(".d-c-close").click(function(){g(),S=!0,m.clear(k),$("#d-c").remove(),x.dispose()}),$("#d-c").css({cursor:"url('https://www.duba.com/static/v2/images/point.cur'),auto"}),{engine:w,runner:B,render:T,canvas:T.canvas,stop:function(){Matter.Render.stop(T),Matter.Runner.stop(B)}}};